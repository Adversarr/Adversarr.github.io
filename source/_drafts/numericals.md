# Numerical Methods from 0 to 0

博士资格考试：数值计算
主要参考书籍: 

1．Numerical Analysis, D. Kincaid, W. Cheney, Wadsworth Group, 2002.第1到9章；
2．Time Dependent Problem and Difference Methods, B. Gustafsson, H. Kreiss and J. Oliger, John Wiley & Sons, 1995。第1到7章；
3．有限元方法的数学基础，王烈衡、许学军，科学出版社，2004。第1到6章；
4．Spline Functions: Basis Theory, L.L. Schumaker, Cambridge University Press, 2007. 第4, 5, 6, 7章；
5．Numerical Partial Differential Equations (finite difference methods), J.W. Thomas, 1998, Springer。

考试要点: 

1．多项式插值和逼近理论，数值微分和积分，常微分方程（组）的数值解；
2．非线性方程和线性方程组的数值求解理论，矩阵特征值及奇异值分解，最小二乘问题；
3．单变量样条函数的性质、计算与逼近理论；
4．偏微分方程差分方法的基本理论与应用；
5．有限元方法：椭圆问题的变分形式，有限元空间的构造，插值误差理论及有限元的误差估计。

# 多项式插值和逼近理论，数值微分和积分，常微分方程（组）的数值解；

## 多项式插值和逼近

### 插值

插值问题的定义：$\phi(x_i) = f(x_i)$

主要问题：
1. 如何选 $\phi$
2. 存在唯一性
3. 误差估计

首先解决存在唯一性问题：

$\det \phi_i(x_j) \ne 0$

多项式插值有几种形式：
1. Lagrange插值：直接用**Lagrange基函数**构造
2. Newton插值：使用**差商表**

误差估计：对于 $k$ 阶插值，误差是$f^{(n+1)}(\xi)/(n+1)! (x-x_0) ... (x-x_n)$

差商的定义：

$$ f[x_0, ..., x_k] = (f[x_1, ..., x_k] - f[x_0, ..., x_{k-1}])/(x_k - x_0)$$

还有一个特殊的是**Hermite插值**，可以实现对导数也插值。原理和Lagrange插值一致，构造基函数然后直接进行插值点的线性组合。

n+1个节点，**误差估计**为：

$$ R= f^((2n+2))/(2n+2)! \prod_i (x-x_i)^2 $$

也可以用类似Newton插值的差商表来计算，误差估计不变。

#### 分段插值

Runge现象

分段插值估计：在区间上用插值多项式的误差估计。

样条函数：保持高阶连续性。

三次样条插值：三类条件
- 连续：在端点 $C^2$，3n-3个
- 插值：在端点和两侧：n+1个
- （还需要两个特殊的、指定的）边界条件：2个

一共是4n个，解线性方程即可

TODO: 误差估计

### 函数逼近

1. 最小平均逼近
2. 最小平方逼近
3. 最小一致逼近

最小二乘法：给定数据序列和函数空间，求函数使得MSE最小。

写成矩阵形式：$Ax = b$，其中的

$$ A = (\varphi_i(x_j)) \quad x = (a_1, .., a_n)\quad b = (y_1, ..., y_m) $$

则有 $Q(x) = \| Ax-b \|_2^2$

1. 线性拟合
2. 二次拟合
3. 其他可以通过变换得到的曲线拟合

法方程组。

**矛盾方程组**：通常无解。最小二乘解

解的存在性：一定有解。可以直接用svd给出证明

解的存在唯一性：如果法方程组的矩阵**列满秩**，就有唯一的最小二乘解。

### 最佳平方逼近和正交多项式

最佳平方逼近多项式。

$$ \sum_j(x^j, x^i)c_i = (f, x^j) $$

正交多项式

周期函数的最佳平方逼近：Fourier级数和Fourier变换

### 最佳一致逼近多项式

## 数值微分和积分

### 数值微分

1. 差商逼近导数
2. 先插值，然后用插值结果来计算微分

第一种分析误差估计直接用Taylor公式即可。

第二种分析误差估计时，需要先得到插值误差估计，然后尝试得到微分的误差

### 数值积分

1. 插值型数值积分，代数精度
2. Newton-Cotes积分：取等距节点
   1. 梯形公式
   2. Simpson公式
   3. 复化梯形、Simpson、**Romberg积分**公式
4. Gauss积分：不选等距离节点，
   1. 选择正交多项式的n个零点

## ODE数值解

主要问题：
1. 如何对定义域离散
2. 微分方程离散？
3. 是否收敛
4. 误差
5. 稳定性
6. 计算效率

### Euler 公式

使用差商代替微分。

阶段误差和收敛性。

中心差商公式、多步法。

### Runge-Kutta

对解函数$f$作 Taylor 展开，注意全微分。对于高阶导数，可以通过取特殊的$x,y$代入$f$中得到。

### 多步法

1. 需要其他算法启动迭代
2. Adams格式

# 非线性方程和线性方程组的数值求解理论，矩阵特征值及奇异值分解，最小二乘问题；

## 非线性方程组求解

二分法：基于介质定理

迭代法：
- 本质：不动点迭代
- newton法：二阶速度
  - 收敛性要求：局部导函数连续，
    - 单根：2阶；重根：1阶
    - 重根按照重数修正可以到2阶
- secant法：超线性

这里还没有提到方程组的求解

## 线性方程组

### 直接法

Gauss 消元法。
- 直接消元
- 列主元消元法
- 全主元消元法

**LU分解**：主要分为三种
1. Dolittle，$l_{ii}=1$
2. Courant，与Dolittle对称
3. LDLT分解：对于对称正定矩阵进行

矩阵范数、矩阵的条件数（要求非奇异）

### 迭代法

Jacobi、Gauss Seidel迭代

迭代的充分条件都是$\rho(M)<1$

这里的$M$是下式给出的：
$$ x^{n+1} = M x^n + g $$

**SOR 迭代**：在 $x^{n}, x^{n+1}$之间进行加权

**逆矩阵计算**：是否必要？

其他的迭代法：Krylove子空间

- SPSD: CG, PCG
- Symm: MINRES, SYMMLQ
- LS: LSQR, LSMR
- Generic: GMRES, BiCG, ...

## 矩阵特征值及奇异值分解

### 最大/最小特征值

通常可以用**幂法**和**反幂法**求得。

收敛速度取决于 $|\lambda_2 / \lambda_1|$

**位移策略**：转化为求 $A - \sigma I$ 的特征值，但是不能改变 $\lambda_1-\sigma$是最大特征值。


**Rayleigh商迭代**：选不固定的$\sigma$

### 对称矩阵的特征值

Jacobi 迭代法：通过一系列 Jacobi 旋转，让 $A$ 正交相似于一个对角矩阵。

通常选 Givens 变换，作为 Jacobi 旋转

**Rayleigh 商迭代法**。

对称QR迭代法。

### QR 分解

分解成正交+上三角矩阵的乘积：其中的 $Q\in C^{m\times n}$，和上三角矩阵 $R$

$$ A = QR $$

满秩矩阵 QR 分解的存在唯一性.

- 存在：考虑Gram-Schmidt正交化过程，取列向量组
- 唯一性：
  - 分析Operator-2 norm，然后得到 $R_1(i, i)=R_2(i, i)$
  - 然后分析 F-norm

有两种方法可以求QR分解。
1. 基于MGS
2. 基于Householder变换

还有一些：Givens变换

QR分解的稳定性：Householder变换更稳定

## SVD分解

Thin SVD, Reduced SVD

## 最小二乘问题

# NPDE

## Chapter 0：背景

Fourier方法
1. 标准正交基的构造
2. Bessel不等式
3. Parseval关系
4. 三角插值、高维三角插值

## 模型方程 -- 对流扩散

### 性质

- 对流：特征线、传播速度有限、能量守恒
- 扩散：无限传播速度、能量稳定

### 格式

FTFS, FTBS, FTCS, BTFS, $\theta$, CN, Leap-Frog

大部分显格式：条件稳定。

大部分隐格式：无条件稳定。

三角插值+某些条件，可以证明二层格式收敛性。

### 稳定性和Fourier分析
很重要

二层：对**放大因子** $\hat Q$ 的分析。

多层格式：很复杂

### CFL condition

真解依赖区被数值解依赖区包含

迎风：条件稳定

逆风：无条件不稳定

### 不稳定格式修正

增加人工粘性并保持相容性。

LF、LW格式

### 局部误差和整体误差

局部误差--相容性。

整体误差--收敛性。

## 适定问题

刻画PDE的性质，如果不适定，那么解是不稳定的，或者不存在且唯一。

1. 对流扩散都是适定的
2. 对称、非对称双曲方程组
   1. (强)双曲问题，如果 A 具有完备的特征向量(A 可以相似对角化)，并且特征值全部为实数;
   2. 称为对称双曲问题，如果 A 是 Hermite 方阵;(显然也是强双曲)

### 标量问题

可以比较复杂，到高阶导数

进行 fourier分解，要求对频率变量 $\omega$ 的实部有上界。

### 抛物方程组

只要满足抛物方程的条件，就是适定的。

### 一般情况的

$$ U_t = P(\partial /\partial x)u $$

要考察$\hat{P} (i \omega)$的特征值。

### 半有界算子和适定性

1. 定义？
2. 可以直接得到适定性。

## FD方法的性质

相容、稳定、收敛
